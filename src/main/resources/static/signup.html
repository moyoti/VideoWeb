<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户注册</title>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        function logout() {
            $.ajax({
                type: "POST",
                url: "/users/loginstats",
                data: {},
                success:function (result) {
                    if(result==1){
                        location.href="logout.html";
                    }
                }
            });
        }
        $(document).ready(function () {
            var tbody;
            $.ajax({
                type: "POST",
                url: "/users/loginstats",
                data: {},
                success:function (result) {
                    if(result[0]==1){
                        tbody=""
                        tbody="<li><img class=\"img-circle\" src=\"http://localhost:8081/pic/20151101201716.jpg\"\n" +
                            "                         style=\"height: 38px;width:38px;margin-top: 6px\"></li>\n" +
                            "                <li><a href=\"#\">"+result[1]+"</a></li>"
                            + "<li><a onclick='logout()'><span class=\"glyphicon glyphicon-log-out\"></span>注销</a></li>";
                        document.getElementById("usershow").innerHTML +=tbody;
                    }else {
                        tbody="<li><a href=\"signup.html\"><span class=\"glyphicon glyphicon-user\"></span> 注册</a></li>\n" +
                            "                <li><a href=\"login.html\"><span class=\"glyphicon glyphicon-log-in\"></span> 登录</a></li>";
                        document.getElementById("usershow").innerHTML +=tbody;
                    }
                }
            });

        });
        function getVerifyCode(obj) {
            obj.src="verify/getImage?"+Math.random();
//            obj.src="verify/getImage";
        }
        function refreshCode() {
            var vci=document.getElementById("verifycode");
            getVerifyCode(vci)
        }
        function regist() {
            var username=$("#u_name").val();
            var password=$("#u_pass").val();
            var email=$("#u_email").val();
            var phone=$("#u_phonenum").val();
            var vc=$("#vcode").val();
            var nickname=$("#u_nick").val();
            $.ajax({
                type: "POST",
                url: "/users/signup",
                data: {password: password,username:username,vcode:vc,email: email, phone: phone, nickname:nickname},
                success: function (re) {
                    if(re==1){
                        alert("注册成功");
                    }else {
                        alert("recheck");
                    }
                }
            })
        }
    </script>
</head>
<body>
<div class="navbar navbar-inverse visible-lg visible-md navbar-fixed-top navbar-hidden" role="navigation"
     style="top: 0px;">
    <div class="container">

        <div class="navbar-header">
            <a class="navbar-brand" href="homepage.html">首页</a>
        </div>
        <div>
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">链接1</a></li>
                <li><a href="#">链接2</a></li>
                <li><a href="#" class="dropdown-toggle" data-toggle="dropdown">链接3</a></li>

            </ul>
            <ul id="usershow" class="nav navbar-nav navbar-right">
                <!--登录时-->
                <!--<li><img class="img-circle" src="http://localhost:8081/pic/20151101201716.jpg"-->
                         <!--style="height: 38px;width:38px;margin-top: 6px"></li>-->
                <!--<li><a href="#">username</a></li>-->
                <!--未登录时-->
                <!--<li><a href="#"><span class="glyphicon glyphicon-user"></span> 注册</a></li>-->
                <!--<li><a href="#"><span class="glyphicon glyphicon-log-in"></span> 登录</a></li>-->
            </ul>
        </div>
    </div>
</div>
<!--<div style="width: 100%;height: 250px">-->
</div>
<div class="container" style="margin-top: 10%">
    <div class="row">
        <div class="col-md-3 col-md-offset-3">
            <label>用户名：</label><span id="usernameErr"></span>
            <input id="u_name" type="text" class="form-control" placeholder="用户名" maxlength="10">
            <label>昵称：</label><span id="nicknameErr"></span>
            <input id="u_nick" type="text" class="form-control" placeholder="昵称" maxlength="10">
            <label>密码：</label><span id="passwordErr"></span>
            <input id="u_pass" type="password" class="form-control" placeholder="密码"maxlength="12">
            <label>确认密码：</label><span id="passwordReErr"></span>
            <input id="u_reck" type="password" class="form-control" placeholder="确认密码"maxlength="12">
            <label>邮箱：</label><span id="emailErr"></span>
            <input id="u_email" type="email" class="form-control" placeholder="邮箱">
            <label>手机号：</label><span id="phoneErr"></span>
            <input id="u_phonenum" type="text" class="form-control" placeholder="手机" maxlength="11">
            <label>验证码：</label><span id="verifyErr"></span>
            <input id="vcode" type="text" class="form-control" placeholder="验证码">
            <img id="verifycode" src="verify/getImage" alt="重新获取" onclick="getVerifyCode(this)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a onclick="refreshCode()">看不清换一张</a><br/>
            <button type="button" class="btn btn-primary" style="margin-top: 10px;width: 100%" onclick="regist()">注册</button>
        </div>
    </div>
</div>
<!--<div class="container">-->
    <!--<div class="row">-->
        <!--<div class="col-md-3">-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->
</body>
</html>